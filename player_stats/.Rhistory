bench= page %>% html_nodes(xpath='//*[@id="main"]/div[10]/div[1]/div/div[2]/table')%>% html_table(fill=T) %>% nth(1) %>% .$X4 %>% na.omit() %>% as.character() %>% str_replace_all(.,"\\(.*\\)",'') %>% tibble(player=.)
bench$lineup="bench"
tb=rbind(titu,bench)
}
if(team==2){
page = url %>% read_html()
titu=page %>% html_nodes(xpath='//*[@id="main"]/div[9]/div[2]/div/div[2]/table') %>% html_table(fill=T) %>% nth(1) %>% .$X4 %>% na.omit() %>% as.character() %>% str_replace_all(.,"\\(.*\\)",'') %>% tibble(player=.)
titu$lineup="player"
bench= page %>% html_nodes(xpath='//*[@id="main"]/div[10]/div[2]/div/div[2]/table')%>% html_table(fill=T) %>% nth(1) %>% .$X4 %>% na.omit() %>% as.character() %>% str_replace_all(.,"\\(.*\\)",'') %>% tibble(player=.)
bench$lineup="bench"
tb=rbind(titu,bench)
}
tb$matchday=matchday
return(tb)
}
#https://www.transfermarkt.com/arsenal-fc/spielplan/verein/11/plus/0?saison_id=2016
getMatchUrl <- function(url){
purrr::map(1:38,function(x) url %>% read_html() %>% html_nodes(xpath=paste0('//*[@id="main"]/div[9]/div[1]/div[5]/div[3]/table/tbody/tr[',x,']/td[10]/a')) %>% html_attr(.,"href") %>% paste0("https://www.transfermarkt.com",.) %>% str_replace_all(.,'index','aufstellung'))
}
getHomeAwayUrl <- function(url){
ifelse(purrr::map(1:38,function(x) url %>% read_html() %>% html_nodes(xpath=paste0('//*[@id="main"]/div[9]/div[1]/div[5]/div[3]/table/tbody/tr[',x,']/td[4]')) %>% html_text())=="H",1,2)
}
list=getMatchUrl("https://www.transfermarkt.com/arsenal-fc/spielplan/verein/11/plus/0?saison_id=2016")
do.call(rbind,map2(getMatchUrl(url),getHomeAwayUrl(url),getLineUp(x,y))
)
do.call(rbind,map2(getMatchUrl(url),getHomeAwayUrl(url),getLineUp(getMatchUrl(url),getHomeAwayUrl(url))))
map(getMatchUrl(url),getHomeAwayurl(url),function(a,b)getLineUp(a,b))
map2(getMatchUrl(url),getHomeAwayurl(url),function(a,b)getLineUp(a,b))
url
url="https://www.transfermarkt.com/arsenal-fc/spielplan/verein/11/plus/0?saison_id=2016"
map2(getMatchUrl(url),getHomeAwayurl(url),function(a,b)getLineUp(a,b))
map(getMatchUrl(url),getHomeAwayUrl(url),function(a,b)getLineUp(a,b))
map2(getMatchUrl(url),getHomeAwayUrl(url),function(a,b)getLineUp(a,b))
a=map2(getMatchUrl(url),getHomeAwayUrl(url),function(a,b)getLineUp(a,b))
a
a=map2(getMatchUrl(url),getHomeAwayUrl(url),function(a,b)getLineUp(a,b))
a
save.image("~/Documents/DevData/scrape/lineup/variableTMP.RData")
all = do.call(rbind,a)
library(ggplot2)
ggplot() + geom_point(data=all,aes(x=matchday,y=player))
ggplot() + geom_point(data=all,aes(x=matchday,y=player,color=lineup))
ggplot() + geom_point(data=all,aes(x=matchday,y=player %>% str_replace(.,"\\s",""),color=lineup))
library(stringr)
ggplot() + geom_point(data=all,aes(x=matchday,y=player %>% str_replace(.,"\\s",""),color=lineup))
all2 = all
all2$player = str_replace_all(all$player,"\\s","")
View(all2)
ggplot() + geom_point(data=all2,aes(x=matchday,y=player,color=lineup))
library(ggplot2)
ggplot() +
geom_rect(aes(xmin = 0, xmax = 100, ymin = 0, ymax = 100), fill = NA, colour = "#000000", size = 1) +
geom_rect(aes(xmin = 0, xmax = 50, ymin = 0, ymax = 100), fill = NA, colour = "#000000", size = 1) +
geom_rect(aes(xmin = 17, xmax = 0, ymin = 21, ymax = 79), fill = NA, colour = "#000000", size = 1) +
geom_rect(aes(xmin = 83, xmax = 100, ymin = 21, ymax = 79), fill = NA, colour = "#000000", size = 1) +
geom_rect(aes(xmin = 0, xmax = 6, ymin = 36.8, ymax = 63.2), fill = NA, colour = "#000000", size = 1) +
geom_rect(aes(xmin = 100, xmax = 94, ymin = 36.8, ymax = 63.2), fill = NA, colour = "#000000", size = 1) +
theme(rect = element_blank(),
line = element_blank(),
text = element_blank())
setwd("~/Documents/DevData/scrape/player_stats")
library(dplyr)
library(rvest)
library(readr)
library(stringr)
#One shot -------------
# url="http://www.rotowire.com/soccer/player.htm?id=16664"
# page = url %>% read_html()
# table = page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1)
# print(table)
urls = read_delim("link_player_PremierLeague.csv",",")
#print(urls$URL)
data=data.frame()
for(u in urls$URL){
tmp = data.frame()
print(u)
page = u %>% read_html()
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position!="Goalkeeper"){
table2016 = page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) %>% filter(Season==2016)
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
Sys.sleep(5)
}
u
player
club
ge
age
position
table2016
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]')
page
page %>% html_nodes(xpath='/html/body/div[3]/div[9]')
page %>% html_nodes(xpath='/html/body/div[3]/div[9]') %>% html_text()
page %>% html_nodes(xpath='/html/body/div[3]/div[8]') %>% html_text()
page %>% html_nodes(xpath='/html/body/div[3]/div[8]/table') %>% html_text()
page %>% html_nodes(xpath='/html/body/div[3]/div[8]/table[1]') %>% html_text()
page %>% html_nodes(xpath='/html/body/div[3]/div[8]/table[1]') %>% html_table()
u
page %>% html_nodes(xpath='/html/body/div[3]/div[8]/table[1]') %>% html_text()
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_text()
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_text() == NULL
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_text() == 0
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table()
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() == NULL
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() == list()
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() == 0
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1)
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) == NULL
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) == 3
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) == "NULL"
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) === NULL
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) = NULL
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) == NULL
page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1)
type(page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1))
typeof(page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1))
typeof(page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1)) == "NULL"
?if
''
?loop
?for
r''
?statment
?breal
?break
urls = read_delim("link_player_PremierLeague.csv",",")
#print(urls$URL)
data=data.frame()
for(u in urls$URL[4:10]){
tmp = data.frame()
print(u)
page = u %>% read_html()
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>t% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper" | typeof(page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1)) == "NULL"){
next
}else{
table2016 = page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) %>% filter(Season==2016)
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
Sys.sleep(5)
}
urls$URL[4:10]
urls = read_delim("link_player_PremierLeague.csv",",")
#print(urls$URL)
data=data.frame()
for(u in urls$URL[4:10]){
tmp = data.frame()
print(u)
page = u %>% read_html()
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper" | typeof(page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1)) == "NULL"){
next
}else{
table2016 = page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) %>% filter(Season==2016)
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
Sys.sleep(5)
}
for(u in urls$URL[10:12]){
tmp = data.frame()
print(u)
page = u %>% read_html()
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper" | typeof(page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1)) == "NULL"){
next
}else{
table2016 = page %>% html_nodes(xpath='/html/body/div[3]/div[9]/table[1]') %>% html_table() %>% nth(1) %>% filter(Season==2016)
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
Sys.sleep(5)
}
page %>% html_nodes(".mlb-player-basicstatsbox > table[1]
")
page %>% html_nodes(".mlb-player-basicstatsbox > table
")
page %>% html_nodes(".mlb-player-basicstatsbox > table
") %>% nth(1)
page %>% html_nodes(".mlb-player-basicstatsbox > table
") %>% nth(1) %>% html_table()
page %>% html_nodes(".mlb-player-basicstatsbox > table
") %>% html_table()
page %>% html_nodes(".mlb-player-basicstatsbox > table[1]
") %>% html_table()
page %>% html_nodes(".mlb-player-basicstatsbox > table:eq(1)
")
page %>% html_nodes(".mlb-player-basicstatsbox > table:(1)
")
page %>% html_nodes(".mlb-player-basicstatsbox > table:1
")
page %>% html_nodes(".mlb-player-basicstatsbox > table:first-child
")
page %>% html_nodes(".mlb-player-basicstatsbox > table > first-child
")
page %>% html_nodes(".mlb-player-basicstatsbox > table
")
page %>% html_nodes(".mlb-player-basicstatsbox > table
") %>% nth(1)
page %>% html_nodes(".mlb-player-basicstatsbox > table
") %>% nth(1) %>% html_table()
page %>% html_nodes(".mlb-player-basicstatsbox > table
") %>% nth(1) %>% html_table(fill=T)
page %>% html_nodes(".mlb-player-basicstatsbox > table
") %>% nth(4) %>% html_table()
u
page %>% html_nodes(".mlb-player-basicstatsbox > table
") %>% nth(3) %>% html_table()
urls = read_delim("link_player_PremierLeague.csv",",")
#print(urls$URL)
data=data.frame()
for(u in urls$URL[10:12]){
tmp = data.frame()
print(u)
page = u %>% read_html()
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper"){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table() %>% filter(Season==2016)
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
Sys.sleep(5)
}
View(data)
urls = read_delim("link_player_PremierLeague.csv",",")
#print(urls$URL)
data=data.frame()
for(u in urls$URL){
tmp = data.frame()
print(u)
page = u %>% read_html()
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper"){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table() %>% filter(Season==2016)
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
Sys.sleep(5)
}
u
player
table2016
urls = read_delim("link_player_PremierLeague.csv",",")
#print(urls$URL)
data=data.frame()
for(u in urls$URL){
tmp = data.frame()
print(u)
page = u %>% read_html()
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper"){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
Sys.sleep(5)
}
View(data)
u
player
position
age
table2016
tmp = data.frame()
print(u)
page = u %>% read_html()
Sys.sleep(5)
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper" | " "){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper" | position=="  "){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
position
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper" | position=="   "){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
position
position=="   "
position=="  "
position=="    "
position=="      "
position=="       "
position=="        "
position
typeof(page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table())
page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table(fill=T)
page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table(fill=T) %>% length()
page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table(fill=T) %>% length() > 5
View(data)
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper" | page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table(fill=T) %>% length() > 5){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
urls = read_delim("link_player_PremierLeague.csv",",")
#print(urls$URL)
data=data.frame()
for(u in urls$URL){
tmp = data.frame()
print(u)
page = u %>% read_html()
Sys.sleep(5)
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position=="Goalkeeper" | page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table(fill=T) %>% length() > 5){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
}
View(data)
data=data.frame()
for(u in urls$URL){
tmp = data.frame()
print(u)
page = u %>% read_html()
Sys.sleep(5)
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position!="Defender" | position!="Midfielder" | position!="Midfielder" | position!="Forward/Midfielder" | position!="Forward"){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
}
View(data)
player
position
position!="Defender"
position!="Midfielder"
position!="Defender" & position!="Midfielder" & position!="Midfielder" & position!="Forward/Midfielder" & position!="Forward"
data=data.frame()
for(u in urls$URL){
tmp = data.frame()
print(u)
page = u %>% read_html()
Sys.sleep(5)
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if(position!="Defender" & position!="Midfielder" & position!="Midfielder" & position!="Forward/Midfielder" & position!="Forward"){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
}
player
url
u
position
table2016
u
ge
age
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table(fill=T)
table2016
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
class(table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table() )
View(data)
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3)
table2016
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
table2016 = tryCatch({
page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
}, error = function(e) {
print(e)
})
table2016
table2016 = tryCatch({
page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
}, error = function(e) {
next
})
table2016 = tryCatch({
page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
}, error = function(e) {
break
})
table2016 = tryCatch({
page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
}, error = function(e) {
data.frame()
})
table2016
table2016 = tryCatch({
page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
})
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table(fill=T)
table2016
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3)
table2016
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_nodes('td')
table2016
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_nodes('td') %>% html_text()
table2016
page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_nodes('td') %>% html_text() == "No stats available for this player."
urls = read_delim("link_player_PremierLeague.csv",",")
#print(urls$URL)
data=data.frame()
for(u in urls$URL){
tmp = data.frame()
print(u)
page = u %>% read_html()
Sys.sleep(5)
player = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[1]') %>% html_text()
club = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/span/text()') %>% html_text()
age = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(1) %>% substring(.,1,2)
position = page %>% html_nodes(xpath='/html/body/div[3]/div[1]/div[2]/div[1]/p[2]/text()') %>% html_text() %>% str_split(.," ") %>% nth(1) %>% nth(2)
if((position!="Defender" & position!="Midfielder" & position!="Midfielder" & position!="Forward/Midfielder" & position!="Forward" )| page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_nodes('td') %>% html_text() == "No stats available for this player."){
next
}else{
table2016 = page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_table()
tmp = data.frame(player,club,age,position,table2016)
data = rbind(data,tmp)
}
print(player)
}
View(data)
u
(position!="Defender" & position!="Midfielder" & position!="Midfielder" & position!="Forward/Midfielder" & position!="Forward" )| page %>% html_nodes(".mlb-player-basicstatsbox > table") %>% nth(3) %>% html_nodes('td') %>% html_text() == "No stats available for this player."
position
u
player
