radarchart( data  , axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=0.8,
#custom labels
vlcex=0.8
)
colors_border=c( rgb(0.2,0.5,0.5,0.9), rgb(0.8,0.2,0.5,0.9))
colors_in=c( rgb(0.2,0.5,0.5,0.4), rgb(0.8,0.2,0.5,0.4))
radarchart( data  , axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20), cglwd=0.8,
#custom labels
vlcex=0.8
)
radarchart( data  , axistype=1)
dat <- read.csv("~/Downloads/Empty google spreadsheet - Feuille 1.csv", dec=",")
View(dat)
colors_border=c( rgb(0.2,0.5,0.5,0.9), rgb(0.8,0.2,0.5,0.9))
colors_in=c( rgb(0.2,0.5,0.5,0.4), rgb(0.8,0.2,0.5,0.4))
radarchart( dat , axistype=1)
colors_border=c( rgb(0.2,0.5,0.5,0.9), rgb(0.8,0.2,0.5,0.9) , rgb(0.7,0.5,0.1,0.9) )
colors_in=c( rgb(0.2,0.5,0.5,0.4), rgb(0.8,0.2,0.5,0.4) , rgb(0.7,0.5,0.1,0.4) )
radarchart( dat  , axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=0.8,
#custom labels
vlcex=0.8
)
legend(x=0.7, y=1, legend = rownames(data[-c(1,2),]), bty = "n", pch=20 , col=colors_in , text.col = "grey", cex=1.2, pt.cex=3)
rownames(dat)=c("Lacazette","Giroud")
dat = dat %>% select(-player)
rownames(dat)=c("Lacazette","Giroud")
dat = dat %>% select(-Player)
rownames(dat)=c("Lacazette","Giroud","max","min")
dat = dat %>% select(-Player)
radarchart( dat  , axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=0.8,
#custom labels
vlcex=0.8
)
radarchart( dat  , axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=0.8,
#custom labels
vlcex=0.8
)
legend(x=0.7, y=1, legend = rownames(data[-c(1,2),]), bty = "n", pch=20 , col=colors_in , text.col = "grey", cex=1.2, pt.cex=3)
radarchart( dat  , axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=0.8,
#custom labels
vlcex=0.8
)
legend(x=0.7, y=1, legend = rownames(dat[-c(1,2),]), bty = "n", pch=20 , col=colors_in , text.col = "grey", cex=1.2, pt.cex=3)
radarchart( dat  , axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,5), cglwd=0.8,
#custom labels
vlcex=0.8
)
legend(x=0.7, y=1, legend = rownames(dat[-c(1,2),]), bty = "n", pch=20 , col=colors_in , text.col = "grey", cex=1.2, pt.cex=3)
ownames(dat[-c(1,2),])
rownames(dat[-c(1,2),])
rownames(dat)
rownames(dat[c(1,2)])
rownames(dat[c(1,2),2])
rownames(dat[c(1,2),])
radarchart( dat  , axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,1,5), cglwd=0.8,
#custom labels
vlcex=0.8
)
legend(x=0.7, y=1, legend = rownames(dat[c(1,2),]), bty = "n", pch=20 , col=colors_in , text.col = "grey", cex=1.2, pt.cex=3)
dat
ozil = data.frame(club=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal"),GoalPer90=c(1*90/2268,16*90/8279,27*90/11377,32*90/13810))
View(ozil)
ozil = data.frame(club=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal"),GoalPer90=c(1*90/2268,16*90/8279,27*90/11377,32*90/13810),AssistsPer90=c(5*90/2268,54*90/8279,81*90/11377,57*90/13810))
library(tidyverse)
ggplot(data=ozil,aes(x=club)) + geom_bar()
ggplot(data=ozil,aes(x=club)) + geom_bar(aes(y=GoalPer90))
ggplot(data=ozil,aes(x=club)) + geom_bar(aes(y=GoalPer90),stat="identity")
ggplot(data=ozil,aes(x=club)) + geom_bar(stat="identity")
ggplot(data=ozil,aes(x=club)) + geom_bar(aes(y=GoalPer90),stat="identity")
ozil.dodge = fortify(ozil)
View(ozil.dodge)
ozil.dodge = melt(ozil)
library(reshape2)
ozil.dodge = melt(ozil)
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity")
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge())
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal"))
library(hrbrthemes)
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) + theme_dark()
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) + theme_rc()
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) + +labs(x="Matchday", y="",title="Manchester City Squad Rotation",subtitle="2016-2017 season",caption="by Benoit Pimpaud / @Ben8t",color="") + theme_ipsum_rc()
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) +labs(x="", y="per 90 minutes",title="Mesut Ozil goals and assists evolution",subtitle="",caption="by Benoit Pimpaud / @Ben8t",color="") + theme_ipsum_rc()
ozil = data.frame(club=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal"),Goals=c(1*90/2268,16*90/8279,27*90/11377,32*90/13810),Assists=c(5*90/2268,54*90/8279,81*90/11377,57*90/13810))
ozil.dodge = melt(ozil)
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) +labs(x="", y="per 90 minutes",title="Mesut Ozil goals and assists evolution",subtitle="",caption="by Benoit Pimpaud / @Ben8t",color="") + theme_ipsum_rc()
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_fill_manual(values=c("#999999", "#E69F00")) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) +labs(x="", y="per 90 minutes",title="Mesut Ozil goals and assists evolution",subtitle="",caption="by Benoit Pimpaud / @Ben8t",color="") + theme_ipsum_rc()
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_fill_manual(values=c("#1de9b6", "#40c4ff")) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) +labs(x="", y="per 90 minutes",title="Mesut Ozil goals and assists evolution",subtitle="",caption="by Benoit Pimpaud / @Ben8t",color="") + theme_ipsum_rc()
# gace_ozil.r
library(tidyverse)
library(hrbrthemes)
library(repshape2)
ozil = data.frame(club=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal"),Goals=c(1*90/2268,16*90/8279,27*90/11377,32*90/13810),Assists=c(5*90/2268,54*90/8279,81*90/11377,57*90/13810))
ozil.dodge = melt(ozil)
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_fill_manual(values=c("#1de9b6", "#40c4ff")) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) +labs(x="", y="per 90 minutes",title="Mesut Ozil goals and assists evolution",subtitle="",caption="by Benoit Pimpaud / @Ben8t",color="") + theme_ipsum_rc()
# gace_ozil.r
library(tidyverse)
library(hrbrthemes)
library(reshape2)
ozil = data.frame(club=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal"),Goals=c(1*90/2268,16*90/8279,27*90/11377,32*90/13810),Assists=c(5*90/2268,54*90/8279,81*90/11377,57*90/13810))
ozil.dodge = melt(ozil)
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_fill_manual(values=c("#1de9b6", "#40c4ff")) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) +labs(x="", y="per 90 minutes",title="Mesut Ozil goals and assists evolution",subtitle="",caption="by Benoit Pimpaud / @Ben8t",color="") + theme_ipsum_rc()
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_fill_manual(values=c("#80cbc4", "#90caf9")) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) +labs(x="", y="per 90 minutes",title="Mesut Ozil goals and assists evolution",subtitle="",caption="by Benoit Pimpaud / @Ben8t",color="") + theme_ipsum_rc()
# gace_ozil.r
library(tidyverse)
library(hrbrthemes)
library(reshape2)
ozil = data.frame(club=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal"),Goals=c(1*90/2268,16*90/8279,27*90/11377,32*90/13810),Assists=c(5*90/2268,54*90/8279,81*90/11377,57*90/13810))
ozil.dodge = melt(ozil)
ggplot(data=ozil.dodge,aes(x=club)) + geom_bar(aes(y=value,fill=variable),stat="identity",position=position_dodge()) + scale_fill_manual(values=c("#1de9b6", "#40c4ff")) + scale_x_discrete(limits=c("Schalke 04","Werder Bremen","Real Madrid","Arsenal")) +labs(x="", y="per 90 minutes",title="Mesut Ozil goals and assists evolution",subtitle="",caption="by Benoit Pimpaud / @Ben8t",color="") + theme_ipsum_rc()
library(rmote)
rmote::start_rmote()
?lm
a=2
a
plot(c(1,2,3),c(2,3,4))
plot_done()
setwd("~/Documents/DevData/FootScrapeViz/Age")
# age.r
library(rvest)
library(plyr)
library(stringr)
library(ggplot2)
library(ggthemes)
library(hrbrthemes)
library(scales)
library(viridis)
library(extrafont)
library(grid)
library(gridExtra)
library(purrr)
library(dplyr)
data = read.csv("data/data.csv", dec=",")
min_played = data %>% group_by(Team,Age.group) %>% summarise(mean_min=sum(Mins))
ggplot(data=min_played,aes(x=Team,y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual(values = c("#26a69a", "#ffd54f","#ffb74d"))+
theme(legend.position = "bottom")+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()
gp9 = data %>% group_by(Team,Age.group) %>% summarise(gp9_avg=mean(GoalsPer90))
ggplot(data=gp9,aes(x=Team,y=gp9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual(values = c("#26a69a", "#ffd54f","#ffb74d"))+
theme(legend.position = "bottom")+
labs(x="", y="Goals per 90 minutes",title="Average number of goals per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()
ggplot(data=min_played,aes(x=Team,y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age",values = c("#26a69a", "#ffd54f","#ffb74d"))+
theme(legend.position = "bottom")+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()
ggplot(data=min_played,aes(x=Team,y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
theme(legend.position = "bottom")+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()
ggplot(data=min_played,aes(x=Team,y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
theme(legend.position = "top")+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()
ggplot(data=min_played,aes(x=Team,y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "top")
ggplot(data=min_played,aes(x=Team,y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "bottom")
ggplot(data=min_played,aes(x=Team,y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
g1 = ggplot(data=min_played,aes(x=Team,y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("Minutes played distribution by age.png",g1,width=750,height=550)
ggsave("Minutes played distribution by age.png",g1,width=10,height=7.3)
ggsave("img/Minutes played distribution by age.png",g1,width=10,height=7.3)
ggsave("img/Minutes played distribution by age.png",g1,width=10,height=7.3)
gp9 = data %>% group_by(Team,Age.group) %>% summarise(gp9_avg=mean(GoalsPer90))
g2 = ggplot(data=gp9,aes(x=Team,y=gp9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Goals per 90 minutes",title="Average number of goals per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of goals per 90 minutes by age.png",g2,width=10,height=7.3)
ap9 = data %>% group_by(Team,Age.group) %>% summarise(ap9_avg=mean(AssistsPer90))
g3 = ggplot(data=ap9,aes(x=Team,y=ap9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Assists per 90 minutes",title="Average number of assists per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
g3
ap9 = data %>% filter(AssistsPer90>5) %>%group_by(Team,Age.group) %>% summarise(ap9_avg=mean(AssistsPer90))
View(ap9)
ap9 = data %>% filter(AssistsPer90<5) %>%group_by(Team,Age.group) %>% summarise(ap9_avg=mean(AssistsPer90))
g3 = ggplot(data=ap9,aes(x=Team,y=ap9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Assists per 90 minutes",title="Average number of assists per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
g3
ap9 = data %>% filter(AssistsPer90<5) %>%group_by(Team,Age.group) %>% summarise(ap9_avg=mean(AssistsPer90))
g3 = ggplot(data=ap9,aes(x=Team,y=ap9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Assists per 90 minutes",title="Average number of assists per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of goals per 90 minutes by age.png",g3,width=10,height=7.3)
# age.r
library(rvest)
library(plyr)
library(stringr)
library(ggplot2)
library(ggthemes)
library(hrbrthemes)
library(scales)
library(viridis)
library(extrafont)
library(grid)
library(gridExtra)
library(purrr)
library(dplyr)
data = read.csv("data/data.csv", dec=",")
min_played = data %>% group_by(Team,Age.group) %>% summarise(mean_min=sum(Mins))
g1 = ggplot(data=min_played,aes(x=Team,y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Minutes played distribution by age.png",g1,width=10,height=7.3)
gp9 = data %>% group_by(Team,Age.group) %>% summarise(gp9_avg=mean(GoalsPer90))
g2 = ggplot(data=gp9,aes(x=Team,y=gp9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Goals per 90 minutes",title="Average number of goals per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of goals per 90 minutes by age.png",g2,width=10,height=7.3)
ap9 = data %>% filter(AssistsPer90<5) %>%group_by(Team,Age.group) %>% summarise(ap9_avg=mean(AssistsPer90))
g3 = ggplot(data=ap9,aes(x=Team,y=ap9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Assists per 90 minutes",title="Average number of assists per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of assists per 90 minutes by age.png",g3,width=10,height=7.3)
View(data)
t = data %>% f%>%group_by(Team,Age.group) %>% summarise(nb=n())
ggplot(data=t,aes(x=Team,y=nb))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Assists per 90 minutes",title="Average number of assists per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
t = data %>% group_by(Team,Age.group) %>% summarise(nb=n())
ggplot(data=t,aes(x=Team,y=nb))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Assists per 90 minutes",title="Average number of assists per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
age = data %>% group_by(Team,Age.group) %>% summarise(nb=n())
g4 = ggplot(data=age,aes(x=Team,y=nb))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Number of players",title="Age distribution in Premier League",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Age distribution in Premier League.png",g4,width=10,height=7.3)
data = read.csv("data/data.csv", dec=",")
min_played = data %>% group_by(Team,Age.group) %>% summarise(mean_min=sum(Mins),score=first(Classement))
View(min_played)
min_played = data %>% group_by(Team,Age.group) %>% summarise(mean_min=sum(Mins),score=first(Classement))
g1 = ggplot(data=min_played,aes(x=reorder(Team,-score),y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
g1
# age.r
library(rvest)
library(plyr)
library(stringr)
library(ggplot2)
library(ggthemes)
library(hrbrthemes)
library(scales)
library(viridis)
library(extrafont)
library(grid)
library(gridExtra)
library(purrr)
library(dplyr)
data = read.csv("data/data.csv", dec=",")
min_played = data %>% group_by(Team,Age.group) %>% summarise(mean_min=sum(Mins),score=first(Classement))
g1 = ggplot(data=min_played,aes(x=reorder(Team,-score),y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Minutes played distribution by age.png",g1,width=10,height=7.3)
gp9 = data %>% group_by(Team,Age.group) %>% summarise(gp9_avg=mean(GoalsPer90),score=first(Classement))
g2 = ggplot(data=gp9,aes(x=reorder(Team,-score),y=gp9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Goals per 90 minutes",title="Average number of goals per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of goals per 90 minutes by age.png",g2,width=10,height=7.3)
ap9 = data %>% filter(AssistsPer90<5) %>%group_by(Team,Age.group) %>% summarise(ap9_avg=mean(AssistsPer90),score=first(Classement))
g3 = ggplot(data=ap9,aes(x=reorder(Team,-score),y=ap9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Assists per 90 minutes",title="Average number of assists per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of assists per 90 minutes by age.png",g3,width=10,height=7.3)
age = data %>% group_by(Team,Age.group) %>% summarise(nb=n(),score=first(Classement))
g4 = ggplot(data=age,aes(x=reorder(Team,-score),y=nb))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Number of players",title="Age distribution in Premier League",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Age distribution in Premier League.png",g4,width=10,height=7.3)
# age.r
library(rvest)
library(plyr)
library(stringr)
library(ggplot2)
library(ggthemes)
library(hrbrthemes)
library(scales)
library(viridis)
library(extrafont)
library(grid)
library(gridExtra)
library(purrr)
library(dplyr)
data = read.csv("data/data.csv", dec=",")
min_played = data %>% group_by(Team,Age.group) %>% summarise(mean_min=sum(Mins),score=first(Classement))
g1 = ggplot(data=min_played,aes(x=reorder(Team,-score),y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Minutes played",title="Minutes played distribution by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Minutes played distribution by age.png",g1,width=10,height=7.3)
gp9 = data %>% group_by(Team,Age.group) %>% summarise(gp9_avg=mean(GoalsPer90),score=first(Classement))
g2 = ggplot(data=gp9,aes(x=reorder(Team,-score),y=gp9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Goals per 90 minutes",title="Average number of goals per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of goals per 90 minutes by age.png",g2,width=10,height=7.3)
ap9 = data %>% filter(AssistsPer90<5) %>%group_by(Team,Age.group) %>% summarise(ap9_avg=mean(AssistsPer90),score=first(Classement))
g3 = ggplot(data=ap9,aes(x=reorder(Team,-score),y=ap9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Assists per 90 minutes",title="Average number of assists per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of assists per 90 minutes by age.png",g3,width=10,height=7.3)
age = data %>% group_by(Team,Age.group) %>% summarise(nb=n(),score=first(Classement))
g4 = ggplot(data=age,aes(x=reorder(Team,-score),y=nb))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Number of players",title="Age distribution in Premier League",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Age distribution in Premier League.png",g4,width=10,height=7.3)
# age.r
library(rvest)
library(plyr)
library(stringr)
library(ggplot2)
library(ggthemes)
library(hrbrthemes)
library(scales)
library(viridis)
library(extrafont)
library(grid)
library(gridExtra)
library(purrr)
library(dplyr)
data = read.csv("data/data.csv", dec=",")
min_played = data %>% group_by(Team,Age.group) %>% summarise(mean_min=sum(Mins),score=first(Classement))
g1 = ggplot(data=min_played,aes(x=reorder(Team,-score),y=mean_min))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Minutes played",title="Minutes played by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Minutes played by age.png",g1,width=10,height=7.3)
gp9 = data %>% group_by(Team,Age.group) %>% summarise(gp9_avg=mean(GoalsPer90),score=first(Classement))
g2 = ggplot(data=gp9,aes(x=reorder(Team,-score),y=gp9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Goals per 90 minutes",title="Average number of goals per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of goals per 90 minutes by age.png",g2,width=10,height=7.3)
ap9 = data %>% filter(AssistsPer90<5) %>%group_by(Team,Age.group) %>% summarise(ap9_avg=mean(AssistsPer90),score=first(Classement))
g3 = ggplot(data=ap9,aes(x=reorder(Team,-score),y=ap9_avg))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Assists per 90 minutes",title="Average number of assists per 90 minutes by age",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Average number of assists per 90 minutes by age.png",g3,width=10,height=7.3)
age = data %>% group_by(Team,Age.group) %>% summarise(nb=n(),score=first(Classement))
g4 = ggplot(data=age,aes(x=reorder(Team,-score),y=nb))+
geom_bar(aes(fill = Age.group),stat = "identity", position = position_stack(reverse = TRUE)) +
coord_flip() +
scale_fill_manual("Age range",values = c("#26a69a", "#ffd54f","#ffb74d"))+
labs(x="", y="Number of players",title="Age distribution in Premier League",subtitle="2016-2017 season",caption="data from WhoScored \nby Benoit Pimpaud / @Ben8t",color="")+
theme_ipsum_rc()+
theme(legend.position = "right")
ggsave("img/Age distribution in Premier League.png",g4,width=10,height=7.3)
View(data)
data %>% group_by(Age) %>% summarise(gp9_avg=mean(GoalsPer90))
data %>% group_by(Age) %>% summarise(gp9_avg=mean(GoalsPer90)) %>% ggplot()
data %>% group_by(Age) %>% summarise(gp9_avg=mean(GoalsPer90)) %>% ggplot(data=.) + geom_line(aes(x=Age,y=gp9_avg))
data %>% filter(Age<35 & Age>21) %>% group_by(Age) %>% summarise(gp9_avg=mean(GoalsPer90)) %>% ggplot(data=.) + geom_line(aes(x=Age,y=gp9_avg))
data %>% filter(Age<35 & Age>21) %>% group_by(Age) %>% summarise(gp9_avg=mean(AssistPer90)) %>% ggplot(data=.) + geom_line(aes(x=Age,y=gp9_avg))
data %>% filter(Age<35 & Age>21) %>% group_by(Age) %>% summarise(gp9_avg=mean(AssistqPer90)) %>% ggplot(data=.) + geom_line(aes(x=Age,y=gp9_avg))
data %>% filter(Age<35 & Age>21) %>% group_by(Age) %>% summarise(gp9_avg=mean(AssistsPer90)) %>% ggplot(data=.) + geom_line(aes(x=Age,y=gp9_avg))
